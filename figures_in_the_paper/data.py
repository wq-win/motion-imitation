from matplotlib import pyplot as plt
import numpy as np
import random
import time
from mpi4py import MPI
import tensorflow as tf
import augmentation_data


TIMESTEP = augmentation_data.TIMESTEP
joint_dict = {'front_right': [0, 1, 2, 0, 1, 2],
              'front_left': [3, 4, 5, 3, 4, 5],
              'back_right': [6, 7, 8, 6, 7, 8],
              'back_left': [9, 10, 11, 9, 10, 11], }

JOINT_INDEX_START = augmentation_data.JOINT_INDEX_START
JOINT_NUMS = augmentation_data.JOINT_NUMS

trot = [
    [0.00000, 0.00000, 0.41758, 0.48548, 0.51475, 0.52474, 0.47328, -0.13469, 0.19749, -0.98728, -
        0.29301, -0.20471, -1.23984, -0.23355, 0.42011, -1.21791, -0.18938, 0.26441, -0.94834],
    [0.03200, 0.00408, 0.42029, 0.48243, 0.51907, 0.51920, 0.47777, -0.14512, 0.26054, -0.95961, -
     0.29102, -0.36855, -1.18856, -0.27333, 0.31933, -1.19782, -0.16195, 0.32940, -0.92682],
    [0.06473, 0.00874, 0.42564, 0.47905, 0.52524, 0.51225, 0.48191, -0.15306, 0.30261, -0.90729, -
     0.25868, -0.48532, -1.10858, -0.30688, 0.20205, -1.13190, -0.13235, 0.37537, -0.87545],
    [0.09805, 0.01381, 0.43253, 0.47488, 0.53203, 0.50551, 0.48568, -0.16337, 0.32781, -0.83305, -
     0.22920, -0.55950, -1.03486, -0.33973, 0.07726, -1.03591, -0.10455, 0.40886, -0.80869],
    [0.13131, 0.01910, 0.44028, 0.46993, 0.53831, 0.49986, 0.48942, -0.16965, 0.34171, -0.74659, -
     0.23311, -0.60282, -0.94829, -0.36301, -0.03726, -0.92726, -0.07940, 0.43395, -0.73493],
    [0.16397, 0.02376, 0.44753, 0.46518, 0.54270, 0.49454, 0.49448, -0.17625, 0.35017, -0.65978, -
     0.19650, -0.61928, -0.86229, -0.37492, -0.13853, -0.82065, -0.06165, 0.46502, -0.67749],
    [0.19598, 0.02731, 0.45305, 0.46190, 0.54454, 0.48996, 0.50006, -0.17989, 0.35836, -0.58379, -
     0.11653, -0.58522, -0.80736, -0.37301, -0.22084, -0.73131, -0.05417, 0.51236, -0.66087],
    [0.22701, 0.02987, 0.45625, 0.45985, 0.54467, 0.48774, 0.50397, -0.18044, 0.36833, -0.54932, -
     0.08977, -0.53380, -0.76223, -0.36188, -0.28908, -0.66566, -0.05688, 0.56185, -0.67457],
    [0.25694, 0.03160, 0.45624, 0.45837, 0.54399, 0.48857, 0.50524, -0.17787, 0.39126, -0.61386, -
     0.09028, -0.47221, -0.71330, -0.33558, -0.32496, -0.62603, -0.06434, 0.61170, -0.71491],
    [0.28671, 0.03236, 0.45280, 0.45725, 0.54283, 0.49077, 0.50537, -0.16933, 0.42446, -0.72625, -
     0.08722, -0.39813, -0.70583, -0.30456, -0.33030, -0.61354, -0.07068, 0.66141, -0.78657],
    [0.31687, 0.03268, 0.44655, 0.45741, 0.54189, 0.49284, 0.50423, -0.17410, 0.44456, -0.86169, -
     0.08785, -0.30924, -0.75960, -0.27382, -0.31084, -0.62046, -0.07733, 0.69563, -0.87640],
    [0.34689, 0.03361, 0.43884, 0.45832, 0.54020, 0.49555, 0.50255, -0.18090, 0.44405, -1.01111, -
     0.09562, -0.21583, -0.83420, -0.26601, -0.24525, -0.67550, -0.08763, 0.71085, -0.97991],
    [0.37605, 0.03510, 0.43093, 0.45954, 0.53727, 0.49932, 0.50084, -0.19220, 0.40517, -1.15108, -
     0.10542, -0.11626, -0.90293, -0.27122, -0.14297, -0.76737, -0.10005, 0.70747, -1.08610],
    [0.40496, 0.03641, 0.42368, 0.46168, 0.53356, 0.50286, 0.49930, -0.20451, 0.30068, -1.25100, -
     0.12191, -0.01085, -0.96244, -0.27744, -0.03505, -0.84941, -0.11237, 0.67923, -1.17895],
    [0.43398, 0.03672, 0.41729, 0.46529, 0.52872, 0.50534, 0.49859, -0.21398, 0.14288, -1.31734, -
     0.13083, 0.09313, -1.00631, -0.27792, 0.05942, -0.90905, -0.12975, 0.62727, -1.25950],
    [0.46252, 0.03630, 0.41416, 0.46857, 0.52247, 0.50815, 0.49925, -0.20933, -0.03553, -1.31434, -
     0.13410, 0.18246, -1.01992, -0.26713, 0.15417, -0.95626, -0.15533, 0.55131, -1.31573],
    [0.49003, 0.03516, 0.41387, 0.47390, 0.51745, 0.50934, 0.49823, -0.18514, -0.20865, -1.24941, -
     0.13137, 0.24918, -1.00930, -0.24675, 0.23442, -0.97250, -0.18472, 0.44756, -1.32951],
    [0.51703, 0.03295, 0.41571, 0.48140, 0.51364, 0.50948, 0.49483, -0.15200, -0.35830, -1.14094, -
     0.12812, 0.29595, -0.98447, -0.22266, 0.30016, -0.96332, -0.21647, 0.32512, -1.29471],
    [0.54507, 0.02911, 0.42020, 0.48926, 0.50925, 0.51065, 0.49044, -0.10030, -0.47457, -0.99850, -
     0.12894, 0.32647, -0.93602, -0.19455, 0.35509, -0.93407, -0.24689, 0.19552, -1.21388],
    [0.57475, 0.02483, 0.42619, 0.49668, 0.50559, 0.51401, 0.48319, -0.07595, -0.54361, -0.90392, -
     0.13124, 0.34496, -0.86624, -0.16334, 0.39909, -0.89050, -0.27480, 0.06162, -1.09754],
    [0.60593, 0.02022, 0.43297, 0.50384, 0.50198, 0.51823, 0.47496, -0.07796, -0.59147, -0.83841, -
     0.13472, 0.35335, -0.78171, -0.13330, 0.43503, -0.83421, -0.29635, -0.06430, -0.96968],
    [0.63802, 0.01588, 0.43983, 0.51004, 0.49891, 0.52258, 0.46677, -0.02444, -0.57695, -0.76569, -
     0.14084, 0.35431, -0.68742, -0.11056, 0.45942, -0.76450, -0.31035, -0.17816, -0.84233],
    [0.66995, 0.01220, 0.44597, 0.51492, 0.49699, 0.52599, 0.45955, 0.03306, -0.51857, -0.74178, -
     0.14370, 0.34841, -0.59691, -0.09653, 0.48009, -0.70593, -0.31628, -0.27009, -0.73351],
    [0.70088, 0.00959, 0.44993, 0.51822, 0.49621, 0.52766, 0.45475, 0.03693, -0.45715, -0.71912, -
     0.14406, 0.33574, -0.54469, -0.09372, 0.50782, -0.68224, -0.31207, -0.34200, -0.66205],
    [0.73035, 0.00804, 0.45044, 0.52031, 0.49605, 0.52720, 0.45307, 0.02213, -0.38793, -0.73939, -
     0.14644, 0.34990, -0.58431, -0.10378, 0.53688, -0.68518, -0.29773, -0.36876, -0.64115],
    [0.75870, 0.00730, 0.44774, 0.52114, 0.49565, 0.52560, 0.45440, -0.00440, -0.30834, -0.79874, -
     0.15446, 0.38900, -0.69914, -0.12304, 0.56939, -0.71815, -0.27581, -0.36458, -0.64736],
    [0.78645, 0.00701, 0.44285, 0.52041, 0.49576, 0.52325, 0.45783, -0.01870, -0.22990, -0.84639, -
     0.17108, 0.43025, -0.84662, -0.14480, 0.60458, -0.77773, -0.24323, -0.34274, -0.65512],
    [0.81350, 0.00700, 0.43717, 0.51825, 0.49603, 0.52142, 0.46204, -0.03190, -0.13705, -0.89790, -
     0.19256, 0.44180, -1.00410, -0.16929, 0.62965, -0.84436, -0.21962, -0.29603, -0.68556],
    [0.83943, 0.00731, 0.43142, 0.51414, 0.49568, 0.52106, 0.46739, -0.05247, -0.04078, -0.94286, -
     0.22764, 0.38617, -1.12246, -0.19891, 0.64651, -0.92152, -0.21120, -0.20773, -0.75772],
    [0.86408, 0.00766, 0.42589, 0.50811, 0.49510, 0.52151, 0.47406, -0.06905, 0.04676, -0.96850, -
     0.26272, 0.27126, -1.20372, -0.23094, 0.65590, -1.00493, -0.20474, -0.09638, -0.84458],
    [0.88800, 0.00537, 0.42062, 0.50131, 0.49551, 0.52224, 0.48002, -0.08727, 0.13061, -0.98216, -
     0.30963, 0.11052, -1.24698, -0.26064, 0.64843, -1.08140, -0.19889, 0.00708, -0.92231],
    [0.91180, 0.00341, 0.41688, 0.49456, 0.49654, 0.52247, 0.48568, -0.09822, 0.20722, -0.98374, -
     0.34176, -0.06244, -1.25238, -0.28866, 0.62110, -1.14684, -0.18915, 0.09785, -0.97609],
    [0.93565, 0.00000, 0.41758, 0.48849, 0.49741, 0.52141, 0.49203, -0.10972, 0.27104, -0.96950, -
     0.35302, -0.23058, -1.21682, -0.31460, 0.57537, -1.20075, -0.16983, 0.18096, -1.01378]
]

pace = [
    [0.00000, 0.00000, 0.43701, 0.49491, 0.53393, 0.49912, 0.46997, -0.12721, 0.07675, -0.95545, -
        0.25301, 0.18682, -1.14403, -0.19362, 0.14030, -0.77823, -0.09528, 0.05437, -0.97596],
    [0.01641, 0.00223, 0.43771, 0.48959, 0.53669, 0.50119, 0.47018, -0.12680, 0.11820, -0.94606, -
     0.28172, 0.03357, -1.16456, -0.20247, 0.17747, -0.77104, -0.09744, -0.05174, -0.93399],
    [0.03278, 0.00476, 0.43896, 0.48274, 0.53845, 0.50530, 0.47084, -0.12518, 0.15584, -0.92492, -
     0.30683, -0.11684, -1.15057, -0.21314, 0.22216, -0.76688, -0.10566, -0.14981, -0.88721],
    [0.04882, 0.00706, 0.44055, 0.47656, 0.53895, 0.50939, 0.47217, -0.12177, 0.19077, -0.89664, -
     0.31713, -0.25529, -1.10780, -0.22449, 0.26890, -0.75917, -0.11668, -0.23940, -0.83319],
    [0.06588, 0.00883, 0.44210, 0.47093, 0.53858, 0.51304, 0.47428, -0.12087, 0.22330, -0.86296, -
     0.31269, -0.35342, -1.05107, -0.23663, 0.31297, -0.74403, -0.12989, -0.31593, -0.77429],
    [0.08286, 0.01033, 0.44397, 0.46634, 0.53774, 0.51543, 0.47717, -0.12319, 0.25043, -0.82652, -
     0.29625, -0.41874, -0.97904, -0.24941, 0.35253, -0.72424, -0.13472, -0.37088, -0.71971],
    [0.09884, 0.01171, 0.44605, 0.46371, 0.53747, 0.51525, 0.48022, -0.12780, 0.26864, -0.79123, -
     0.27806, -0.47452, -0.91527, -0.26153, 0.38053, -0.69634, -0.13017, -0.40471, -0.67348],
    [0.11564, 0.01337, 0.44783, 0.46172, 0.53682, 0.51397, 0.48422, -0.13502, 0.28660, -0.75117, -
     0.28068, -0.51479, -0.83098, -0.27053, 0.40688, -0.66852, -0.11715, -0.41160, -0.63590],
    [0.13247, 0.01557, 0.44866, 0.46017, 0.53653, 0.51145, 0.48867, -0.14270, 0.30399, -0.71655, -
     0.21607, -0.52903, -0.77176, -0.27539, 0.43360, -0.64668, -0.10623, -0.37913, -0.63582],
    [0.14967, 0.01760, 0.44808, 0.45870, 0.53617, 0.50991, 0.49205, -0.14760, 0.32861, -0.68749, -
     0.16653, -0.50534, -0.73515, -0.27867, 0.47223, -0.65260, -0.10817, -0.30617, -0.68954],
    [0.16688, 0.01936, 0.44679, 0.45801, 0.53697, 0.50846, 0.49332, -0.14926, 0.35277, -0.66859, -
     0.14587, -0.46223, -0.71030, -0.27905, 0.52277, -0.69369, -0.10386, -0.25300, -0.72486],
    [0.18457, 0.02113, 0.44491, 0.45884, 0.53861, 0.50792, 0.49131, -0.14788, 0.37881, -0.65994, -
     0.12952, -0.41299, -0.68721, -0.26795, 0.55542, -0.74544, -0.10247, -0.19779, -0.76080],
    [0.20315, 0.02255, 0.44338, 0.46159, 0.54103, 0.50733, 0.48666, -0.14168, 0.40260, -0.65184, -
     0.16240, -0.34246, -0.76043, -0.24415, 0.54899, -0.78040, -0.10484, -0.15274, -0.78151],
    [0.22288, 0.02351, 0.44195, 0.46521, 0.54355, 0.50682, 0.48089, -0.13629, 0.42854, -0.65674, -
     0.16512, -0.29743, -0.79699, -0.22199, 0.52110, -0.82139, -0.10857, -0.11585, -0.79425],
    [0.24349, 0.02420, 0.44024, 0.46907, 0.54564, 0.50727, 0.47426, -0.12753, 0.44960, -0.68466, -
     0.17700, -0.23585, -0.84852, -0.21056, 0.47836, -0.87137, -0.11339, -0.07894, -0.80477],
    [0.26441, 0.02473, 0.43823, 0.47325, 0.54703, 0.50712, 0.46865, -0.11968, 0.45798, -0.76842, -
     0.19037, -0.17536, -0.89554, -0.20650, 0.44393, -0.92752, -0.11522, -0.04086, -0.81465],
    [0.28558, 0.02464, 0.43620, 0.47835, 0.54689, 0.50616, 0.46464, -0.12197, 0.43800, -0.86342, -
     0.19421, -0.11435, -0.93678, -0.19062, 0.40079, -0.97485, -0.11837, -0.00403, -0.82084],
    [0.30563, 0.02398, 0.43551, 0.48404, 0.54571, 0.50448, 0.46196, -0.12253, 0.41137, -0.95532, -
     0.19119, -0.06019, -0.96439, -0.17122, 0.33514, -1.00492, -0.11824, 0.02713, -0.81663],
    [0.32565, 0.02340, 0.43543, 0.48863, 0.54314, 0.50286, 0.46192, -0.12639, 0.37667, -1.06982, -
     0.18340, -0.00535, -0.97909, -0.16186, 0.24489, -1.00477, -0.11752, 0.06483, -0.81530],
    [0.34513, 0.02264, 0.43600, 0.49248, 0.53972, 0.50166, 0.46315, -0.13757, 0.29075, -1.15527, -
     0.17385, 0.04504, -0.97993, -0.16089, 0.14852, -0.98629, -0.11866, 0.10202, -0.80805],
    [0.36352, 0.02156, 0.43678, 0.49651, 0.53506, 0.50047, 0.46553, -0.14822, 0.15752, -1.19552, -
     0.16643, 0.09010, -0.97221, -0.16121, 0.04991, -0.95571, -0.12166, 0.14042, -0.79969],
    [0.38133, 0.01988, 0.43839, 0.50053, 0.52944, 0.49854, 0.46971, -0.15608, 0.00492, -1.19387, -
     0.15410, 0.13039, -0.95309, -0.16926, -0.05029, -0.90903, -0.12653, 0.17847, -0.78722],
    [0.39841, 0.01837, 0.44059, 0.50384, 0.52281, 0.49739, 0.47479, -0.15983, -0.13783, -1.15844, -
     0.14303, 0.16753, -0.92657, -0.18165, -0.14768, -0.85218, -0.13280, 0.21770, -0.77474],
    [0.41513, 0.01669, 0.44294, 0.50649, 0.51629, 0.49694, 0.47954, -0.15788, -0.25191, -1.09422, -
     0.13183, 0.19619, -0.88943, -0.19374, -0.23443, -0.78796, -0.14329, 0.25547, -0.75380],
    [0.43177, 0.01473, 0.44521, 0.50907, 0.51037, 0.49701, 0.48306, -0.15548, -0.33574, -1.01839, -
     0.12400, 0.22032, -0.84860, -0.20385, -0.30441, -0.72873, -0.15418, 0.28667, -0.72651],
    [0.44802, 0.01314, 0.44760, 0.51097, 0.50622, 0.49819, 0.48420, -0.15480, -0.40127, -0.95462, -
     0.12135, 0.23766, -0.80623, -0.20927, -0.35212, -0.67100, -0.16640, 0.31242, -0.69448],
    [0.46489, 0.01140, 0.45021, 0.51169, 0.50451, 0.49981, 0.48356, -0.14707, -0.45308, -0.87697, -
     0.11954, 0.25095, -0.75704, -0.21183, -0.38106, -0.61525, -0.17028, 0.33364, -0.66014],
    [0.48202, 0.00922, 0.45259, 0.51313, 0.50273, 0.50274, 0.48085, -0.08334, -0.47429, -0.78665, -
     0.12094, 0.26006, -0.70915, -0.19570, -0.37232, -0.58446, -0.17731, 0.34955, -0.62396],
    [0.49978, 0.00692, 0.45301, 0.51399, 0.49995, 0.50649, 0.47889, -0.03442, -0.44226, -0.72261, -
     0.12344, 0.27515, -0.66283, -0.19484, -0.31002, -0.61017, -0.18530, 0.38462, -0.62481],
    [0.51793, 0.00522, 0.45155, 0.51416, 0.49704, 0.50996, 0.47805, -0.03327, -0.39805, -0.70482, -
     0.12444, 0.29801, -0.62361, -0.20098, -0.25119, -0.65274, -0.19097, 0.44064, -0.67343],
    [0.53748, 0.00395, 0.44913, 0.51411, 0.49529, 0.51164, 0.47813, -0.07110, -0.32111, -0.76216, -
     0.12382, 0.32680, -0.59657, -0.19979, -0.19735, -0.68530, -0.18261, 0.49555, -0.73822],
    [0.55659, 0.00280, 0.44697, 0.51485, 0.49644, 0.50985, 0.47805, -0.07549, -0.26493, -0.80317, -
     0.11877, 0.35467, -0.59078, -0.20209, -0.14052, -0.72329, -0.16125, 0.51232, -0.79071],
    [0.57577, 0.00167, 0.44507, 0.51650, 0.49783, 0.50696, 0.47789, -0.07131, -0.21348, -0.82662, -
     0.11386, 0.37332, -0.60466, -0.19963, -0.08971, -0.74502, -0.14228, 0.49408, -0.83879],
    [0.59497, 0.00154, 0.44312, 0.51800, 0.50013, 0.50330, 0.47774, -0.08576, -0.15562, -0.87133, -
     0.11535, 0.37462, -0.65372, -0.20273, -0.04893, -0.76230, -0.12839, 0.46938, -0.90473],
    [0.61400, 0.00191, 0.44160, 0.51843, 0.50324, 0.49974, 0.47774, -0.09484, -0.10177, -0.90486, -
     0.12731, 0.36711, -0.75677, -0.20671, -0.01317, -0.77205, -0.11790, 0.43685, -0.97024],
    [0.63303, 0.00233, 0.44009, 0.51746, 0.50557, 0.49713, 0.47905, -0.10425, -0.04639, -0.92873, -
     0.14730, 0.35852, -0.86271, -0.21267, 0.02886, -0.78466, -0.10501, 0.39079, -1.01703],
    [0.65155, 0.00263, 0.43886, 0.51586, 0.50831, 0.49492, 0.48016, -0.11146, 0.00547, -0.94503, -
     0.18348, 0.32590, -0.98252, -0.21663, 0.07145, -0.79413, -0.09216, 0.31946, -1.04176],
    [0.67005, 0.00126, 0.43824, 0.51299, 0.51174, 0.49342, 0.48113, -0.12047, 0.05387, -0.95210, -
     0.21892, 0.23998, -1.07604, -0.22485, 0.10828, -0.79239, -0.08403, 0.22582, -1.04134],
    [0.68773, 0.00000, 0.43701, 0.50903, 0.51581, 0.49242, 0.48203, -0.12785, 0.09815, -0.95073, -
     0.26299, 0.10340, -1.12756, -0.23415, 0.13683, -0.78085, -0.07723, 0.11886, -1.01564]
]

spin = [
    [0.00000, 0.00000, 0.44976, 0.54057, 0.44882, 0.49571, 0.51052, 0.06576, -0.04242, -0.82964, -
        0.28412, 0.03276, -0.85943, -0.05603, -0.06834, -0.80993, 0.18463, 0.14715, -0.92528],
    [0.00170, -0.00521, 0.44895, 0.53396, 0.46602, 0.50437, 0.49328, 0.08427, -0.04042, -0.84964, -
     0.26965, 0.02893, -0.90262, -0.08150, -0.08507, -0.79410, 0.11790, 0.12385, -0.94709],
    [0.00294, -0.01037, 0.44906, 0.52667, 0.48140, 0.51294, 0.47724, 0.10163, -0.04171, -0.86061, -
     0.24761, 0.02580, -0.94555, -0.10571, -0.10000, -0.77467, 0.05056, 0.09522, -0.94786],
    [0.00427, -0.01548, 0.44956, 0.51835, 0.49567, 0.52238, 0.46125, 0.12089, -0.04302, -0.86683, -
     0.21255, 0.03453, -0.99109, -0.12795, -0.11315, -0.75647, -0.01603, 0.06023, -0.92879],
    [0.00526, -0.02026, 0.45050, 0.50886, 0.50938, 0.53230, 0.44525, 0.14275, -0.04471, -0.86730, -
     0.16893, 0.04941, -1.04211, -0.14831, -0.12830, -0.73635, -0.07620, 0.02178, -0.89569],
    [0.00660, -0.02422, 0.45199, 0.49779, 0.52177, 0.54282, 0.43048, 0.16632, -0.04216, -0.85923, -
     0.11659, 0.07414, -1.08248, -0.16676, -0.14716, -0.70362, -0.13189, -0.00839, -0.86821],
    [0.00816, -0.02738, 0.45291, 0.48520, 0.53279, 0.55408, 0.41679, 0.18885, -0.03685, -0.84672, -
     0.06279, 0.11092, -1.12056, -0.18593, -0.15269, -0.68631, -0.16323, -0.03373, -0.84157],
    [0.00912, -0.02982, 0.45334, 0.47064, 0.54404, 0.56518, 0.40384, 0.21070, -0.03267, -0.83000, -
     0.01177, 0.15189, -1.14205, -0.20995, -0.14839, -0.68509, -0.16257, -0.06147, -0.79858],
    [0.00959, -0.03131, 0.45411, 0.45509, 0.55530, 0.57608, 0.39072, 0.23517, -0.02957, -0.80754,
     0.03302, 0.19194, -1.11850, -0.23488, -0.15766, -0.67462, -0.16007, -0.07681, -0.75131],
    [0.00820, -0.03198, 0.45512, 0.43882, 0.56589, 0.58720, 0.37737, 0.26272, -0.03132, -0.77755,
     0.06785, 0.22387, -1.05869, -0.25299, -0.15864, -0.68217, -0.14566, -0.08876, -0.72233],
    [0.00543, -0.03250, 0.45493, 0.42083, 0.57510, 0.59930, 0.36471, 0.29036, -0.03125, -0.74467,
     0.09422, 0.25073, -0.97785, -0.27355, -0.11169, -0.74634, -0.12336, -0.08627, -0.72625],
    [0.00266, -0.03330, 0.45293, 0.40085, 0.58320, 0.61230, 0.35254, 0.31519, -0.02544, -0.71341,
     0.11186, 0.27263, -0.88991, -0.28671, -0.04936, -0.81543, -0.11084, -0.07331, -0.73991],
    [-0.00085, -0.03443, 0.45017, 0.37994, 0.59053, 0.62475, 0.34147, 0.33621, -0.01982, -0.68099,
     0.12074, 0.28914, -0.79551, -0.28361, 0.02722, -0.89477, -0.09932, -0.06020, -0.76248],
    [-0.00634, -0.03619, 0.44723, 0.36039, 0.59826, 0.63447, 0.33113, 0.35389, -0.02085, -0.65397,
     0.11318, 0.28671, -0.70350, -0.26150, 0.10645, -1.00152, -0.07910, -0.05584, -0.78561],
    [-0.01309, -0.03839, 0.44395, 0.34218, 0.60757, 0.64119, 0.32037, 0.37007, -0.02580, -0.63565,
     0.09700, 0.27234, -0.64727, -0.21539, 0.18061, -1.10211, -0.05350, -0.06842, -0.79983],
    [-0.01936, -0.04049, 0.44018, 0.32374, 0.61866, 0.64630, 0.30781, 0.38802, -0.02803, -0.62488,
     0.08022, 0.27466, -0.67156, -0.14826, 0.23933, -1.17471, -0.02692, -0.09472, -0.80488],
    [-0.02494, -0.04317, 0.43729, 0.30436, 0.63159, 0.64990, 0.29342, 0.40442, -0.03224, -0.61571,
     0.07788, 0.26924, -0.73006, -0.07056, 0.27236, -1.20235, -0.00018, -0.13179, -0.79824],
    [-0.02932, -0.04633, 0.43552, 0.28442, 0.64515, 0.65290, 0.27676, 0.42248, -0.03499, -0.60695,
     0.07813, 0.25674, -0.76520, 0.01565, 0.25803, -1.16953, 0.02243, -0.17780, -0.77968],
    [-0.03184, -0.04887, 0.43470, 0.26449, 0.65781, 0.65627, 0.25815, 0.44312, -0.03093, -0.60124,
     0.07032, 0.24734, -0.80087, 0.08361, 0.22405, -1.09286, 0.03924, -0.22582, -0.75262],
    [-0.03289, -0.05072, 0.43489, 0.24439, 0.66848, 0.66046, 0.23916, 0.46143, -0.02316, -0.59879,
     0.05933, 0.23618, -0.82066, 0.12051, 0.20659, -0.99043, 0.05365, -0.26812, -0.72343],
    [-0.03320, -0.05198, 0.43517, 0.22452, 0.67589, 0.66649, 0.22036, 0.47541, -0.01056, -0.60693,
     0.04476, 0.23091, -0.82830, 0.13333, 0.21474, -0.89054, 0.06329, -0.30053, -0.70281],
    [-0.03402, -0.05331, 0.43476, 0.20529, 0.67901, 0.67509, 0.20263, 0.47786, 0.00542, -0.62423,
     0.02775, 0.23387, -0.82772, 0.12607, 0.23394, -0.85245, 0.06711, -0.31594, -0.69964],
    [-0.03545, -0.05442, 0.43341, 0.18714, 0.67843, 0.68572, 0.18574, 0.46840, 0.02541, -0.64862,
     0.00692, 0.24142, -0.82339, 0.09073, 0.27650, -0.88971, 0.06534, -0.31130, -0.71662],
    [-0.03754, -0.05531, 0.43273, 0.17030, 0.67675, 0.69595, 0.16927, 0.44696, 0.05146, -
     0.68563, -0.01593, 0.24399, -0.81205, 0.03948, 0.28861, -0.91399, 0.06061, -0.30093, -0.73706],
    [-0.04077, -0.05732, 0.43413, 0.15545, 0.67608, 0.70374, 0.15329, 0.41601, 0.07273, -
     0.73896, -0.03993, 0.23376, -0.79742, 0.00111, 0.28856, -0.92632, 0.05428, -0.30352, -0.73901],
    [-0.04404, -0.06019, 0.43745, 0.14245, 0.67675, 0.70876, 0.13921, 0.37668, 0.07835, -0.79680, -
     0.05741, 0.21535, -0.77849, -0.02091, 0.29496, -0.92252, 0.05020, -0.31831, -0.72156],
    [-0.04682, -0.06286, 0.44148, 0.12972, 0.67807, 0.71234, 0.12635, 0.32881, 0.07527, -0.85365, -
     0.07128, 0.19468, -0.76047, -0.03238, 0.30372, -0.90682, 0.04994, -0.33116, -0.70408],
    [-0.04911, -0.06459, 0.44379, 0.11697, 0.67839, 0.71628, 0.11422, 0.27572, 0.07319, -0.91204, -
     0.08422, 0.18025, -0.74867, -0.04532, 0.31617, -0.90536, 0.05267, -0.32536, -0.71021],
    [-0.05093, -0.06550, 0.44470, 0.10511, 0.67751, 0.72053, 0.10376, 0.21732, 0.07119, -0.96703, -
     0.09393, 0.17193, -0.73741, -0.06504, 0.32477, -0.91245, 0.06101, -0.30377, -0.73499],
    [-0.05293, -0.06640, 0.44578, 0.09388, 0.67684, 0.72395, 0.09476, 0.15536, 0.05792, -1.00485, -
     0.10214, 0.16456, -0.72823, -0.08559, 0.33180, -0.91824, 0.07641, -0.27847, -0.75957],
    [-0.05519, -0.06753, 0.44767, 0.08371, 0.67652, 0.72648, 0.08679, 0.09459, 0.02908, -1.01695, -
     0.10797, 0.15397, -0.71810, -0.09974, 0.33731, -0.91660, 0.09359, -0.24760, -0.78023],
    [-0.05737, -0.06786, 0.45013, 0.07555, 0.67643, 0.72835, 0.07902, 0.04112, -0.00867, -
     1.00484, -0.11713, 0.14079, -0.70063, -0.10679, 0.33580, -0.90562, 0.10379, -0.20611, -0.80257],
    [-0.05902, -0.06750, 0.45259, 0.06955, 0.67639, 0.72974, 0.07166, -0.00802, -0.04812, -
     0.97086, -0.12849, 0.12875, -0.68162, -0.11000, 0.33418, -0.89653, 0.11106, -0.15600, -0.82436],
    [-0.06014, -0.06728, 0.45473, 0.06529, 0.67706, 0.73017, 0.06466, -0.04634, -0.08522, -
     0.91782, -0.13812, 0.11688, -0.66726, -0.11211, 0.33047, -0.88803, 0.12050, -0.11094, -0.82888],
    [-0.06076, -0.06699, 0.45632, 0.06194, 0.67903, 0.72922, 0.05766, -0.06528, -0.11733, -
     0.84635, -0.14799, 0.10563, -0.66086, -0.11463, 0.32168, -0.87639, 0.12842, -0.08373, -0.81427],
    [-0.06076, -0.06581, 0.45689, 0.05907, 0.68211, 0.72715, 0.04980, -0.09067, -0.13459, -
     0.79078, -0.16026, 0.09876, -0.66390, -0.11722, 0.31041, -0.86469, 0.12938, -0.07522, -0.79244],
    [-0.06002, -0.06342, 0.45668, 0.05695, 0.68646, 0.72384, 0.03970, -0.11310, -0.13507, -
     0.75190, -0.17638, 0.09583, -0.67341, -0.11685, 0.29881, -0.85512, 0.11951, -0.08701, -0.76523],
    [-0.05895, -0.06019, 0.45591, 0.05452, 0.69199, 0.71930, 0.02798, -0.10891, -0.11880, -
     0.76040, -0.19524, 0.09555, -0.68733, -0.11594, 0.28492, -0.84398, 0.10343, -0.11727, -0.73485],
    [-0.05808, -0.05613, 0.45477, 0.05094, 0.69801, 0.71410, 0.01549, -0.07747, -0.10810, -
     0.79850, -0.21422, 0.10028, -0.70326, -0.11680, 0.26761, -0.82950, 0.08650, -0.15288, -0.70526],
    [-0.05753, -0.05231, 0.45338, 0.04639, 0.70439, 0.70828, 0.00319, -0.03301, -0.11085, -
     0.82038, -0.23428, 0.10488, -0.72150, -0.11899, 0.24809, -0.81580, 0.07317, -0.18467, -0.68128],
    [-0.05747, -0.04923, 0.45198, 0.04068, 0.71071, 0.70225, -0.00904, -0.01758, -0.10790, -
     0.84636, -0.25605, 0.10873, -0.74243, -0.12189, 0.22486, -0.79935, 0.06314, -0.21215, -0.65875],
    [-0.05792, -0.04647, 0.45109, 0.03399, 0.71593, 0.69703, -0.02095, 0.00006, -0.10366, -
     0.86946, -0.27510, 0.11554, -0.76366, -0.12523, 0.20531, -0.78451, 0.05646, -0.23556, -0.63572],
    [-0.05882, -0.04361, 0.45019, 0.02713, 0.71949, 0.69326, -0.03141, 0.03287, -0.09512, -
     0.88789, -0.29004, 0.12726, -0.79395, -0.12931, 0.19555, -0.77718, 0.05211, -0.25003, -0.62144],
    [-0.05992, -0.04054, 0.44873, 0.02067, 0.72158, 0.69085, -0.04025, 0.05403, -0.08453, -
     0.90197, -0.29695, 0.13986, -0.83528, -0.13466, 0.19422, -0.77640, 0.04861, -0.25566, -0.61785],
    [-0.06108, -0.03739, 0.44707, 0.01493, 0.72265, 0.68946, -0.04700, 0.06789, -0.07218, -
     0.91362, -0.29616, 0.14736, -0.89468, -0.14136, 0.19899, -0.78058, 0.04652, -0.25549, -0.62093],
    [-0.06250, -0.03430, 0.44976, 0.00997, 0.72297, 0.68887, -0.05169, 0.08011, -0.06003, -
     0.91923, -0.27336, 0.15206, -0.96575, -0.14895, 0.20538, -0.78397, 0.04516, -0.25292, -0.62641]
]

trot_array = np.array(
    trot)[:, JOINT_INDEX_START: JOINT_INDEX_START + JOINT_NUMS]
pace_array = np.array(
    pace)[:, JOINT_INDEX_START: JOINT_INDEX_START + JOINT_NUMS]
spin_array = np.array(
    spin)[:, JOINT_INDEX_START: JOINT_INDEX_START + JOINT_NUMS]


def set_rand_seed(seed=None):
    if seed is None:
        seed = int(time.time())
    seed += 97 * MPI.COMM_WORLD.Get_rank()
    tf.set_random_seed(seed)
    np.random.seed(seed)
    random.seed(seed)
    return


def set_axes_equal(ax):
    """
    Make axes of 3D plot have equal scale so that spheres appear as spheres,
    cubes as cubes, etc.

    Input
      ax: a matplotlib axis, e.g., as output from plt.gca().
    """

    x_limits = ax.get_xlim3d()
    y_limits = ax.get_ylim3d()
    z_limits = ax.get_zlim3d()

    x_range = abs(x_limits[1] - x_limits[0])
    x_middle = np.mean(x_limits)
    y_range = abs(y_limits[1] - y_limits[0])
    y_middle = np.mean(y_limits)
    z_range = abs(z_limits[1] - z_limits[0])
    z_middle = np.mean(z_limits)

    # The plot bounding box is a sphere in the sense of the infinity
    # norm, hence I call half the max range the plot radius.
    plot_radius = 0.5 * max([x_range, y_range, z_range])

    ax.set_xlim3d([x_middle - plot_radius, x_middle + plot_radius])
    ax.set_ylim3d([y_middle - plot_radius, y_middle + plot_radius])
    ax.set_zlim3d([z_middle - plot_radius, z_middle + plot_radius])


def ploter(position, direction, is_set_axes_equal=True, color_array=None, plt_legend=None, plt_title=None, x=0, y=1, z=2, u=0, v=1, w=2):
    fig = plt.figure()
    i = 0
    for k, v in joint_dict.items():
        x, y, z, u, v, w = v

        ax = fig.add_subplot(2, 2, i+1, projection='3d')
        X = position[:, x]
        Y = position[:, y]
        Z = position[:, z]
        U = direction[:, u]
        V = direction[:, v]
        W = direction[:, w]
        if color_array is None:
            ax.quiver(X, Y, Z, U, V, W, length=TIMESTEP, normalize=False,)
        else:
            ax.quiver(X, Y, Z, U, V, W, length=TIMESTEP, 
                      normalize=False, color=color_array)
        ax.view_init(elev=10, azim=-30)
        ax.set_xlabel(f'X-axis:joint{x} ABDUCTION')
        ax.set_ylabel(f'Y-axis:joint{y} HIP')
        ax.set_zlabel(f'Z-axis:joint{z} KNEE')
        ax.set_title(f'{k}')
        if plt_legend is not None:
            ax.legend([ax],['a'])
        if is_set_axes_equal:
            set_axes_equal(ax)
        i += 1
    if plt_title is not None:
        plt.suptitle(f'{plt_title}')
    plt.show()

# def label_ploter(data =[], color=[], labels=[]):
#     assert len(position_data)==len(direction_data)==len(labels),  'len of data and labels must be equal'
#     for i in range(len(data)):
#         position_data, direction_data = data[i]
#         ploter(position_data, direction_data, )
    
